{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/all_courses.css' %}">
    <title>All Courses</title>
</head>
<body>
    <header class="top-bar">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <a href="{% url 'home' %}">
                <img src="{% static 'images/LKWLogo.png' %}" alt="LKW Wellness Logo" class="logo">
            </a>
            <nav>
                <a href="{% url 'login' %}" class="btn btn-link">Sign in</a>
                <a href="{% url 'register' %}" class="btn btn-custom">Register</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section with Background Color -->
    <section class="hero-section">
        <div class="hero-bg">
            <div class="menu-icon">
                <i class="fas fa-bars"></i>
            </div>
            <div>
                <a href="{% url 'all_courses' %}" class="btn btn-primary">All Courses</a>
            </div>
            <div class="search-box">
                <form method="GET" action="{% url 'all_courses' %}">
                    <label>
                        <input type="text" name="search" placeholder="Search" value="{{ request.GET.search|default:'' }}">
                    </label>
                    <button type="submit"><i class="fas fa-search"></i></button>
                </form>
            </div>

            <div class="logo-center">
                <a href="{% url 'home' %}">
                    <img src="{% static 'images/LKWLogo.png' %}" alt="LKW Wellness Logo" class="logo-image">
                </a>
            </div>

            <!-- Filter Bar Form -->
            <div class="filter-bar">
                <div class="container">
                    <form method="GET" action="{% url 'all_courses' %}">
                        <div class="row justify-content-center">
                            <!-- Subject Area Dropdown -->
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="subject_area">Subject Area:</label>
                                    <select name="subject_area" id="subject_area" class="form-control">
                                        <option value="">Select...</option>
                                        {% for subject_area in subject_areas %}
                                            <option value="{{ subject_area.id }}" {% if request.GET.subject_area == subject_area.id|stringformat:"s" %}selected{% endif %}>{{ subject_area.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <!-- Price Dropdown -->
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="price">Price:</label>
                                    <select name="price" id="price" class="form-control">
                                        <option value="">Select...</option>
                                        <option value="free" {% if request.GET.price == 'free' %}selected{% endif %}>Free</option>
                                        <option value="paid" {% if request.GET.price == 'paid' %}selected{% endif %}>Paid</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Start Date Dropdown -->
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="start_date">Start Date:</label>
                                    <select name="start_date" id="start_date" class="form-control">
                                        <option value="">Select...</option>
                                        <option value="1_week" {% if request.GET.start_date == '1_week' %}selected{% endif %}>Within 1 week</option>
                                        <option value="1_month" {% if request.GET.start_date == '1_month' %}selected{% endif %}>Within 1 month</option>
                                        <option value="3_months" {% if request.GET.start_date == '3_months' %}selected{% endif %}>Within 3 months</option>
                                        <option value="6_months" {% if request.GET.start_date == '6_months' %}selected{% endif %}>Within 6 months</option>
                                        <option value="1_year" {% if request.GET.start_date == '1_year' %}selected{% endif %}>Within 1 year</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Duration Dropdown -->
                            <div class="col-md-2">
    <div class="form-group">
        <label for="duration">Duration:</label>
        <select name="duration" id="duration" class="form-control">
            <option value="">Select...</option>
            <option value="0_1" {% if request.GET.duration == '0_1' %}selected{% endif %}>0 - 1 week</option>
            <option value="1_3" {% if request.GET.duration == '1_3' %}selected{% endif %}>1 - 3 weeks</option>
            <option value="3_6" {% if request.GET.duration == '3_6' %}selected{% endif %}>3 - 6 weeks</option>
            <option value="6_9" {% if request.GET.duration == '6_9' %}selected{% endif %}>6 - 9 weeks</option>
            <option value="9_12" {% if request.GET.duration == '9_12' %}selected{% endif %}>9 - 12 weeks</option>
            <option value="12_plus" {% if request.GET.duration == '12_plus' %}selected{% endif %}>12+ weeks</option>
        </select>
    </div>
</div>

                            <!-- Modality Dropdown -->
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="modality">Modality:</label>
                                    <select name="modality" id="modality" class="form-control">
                                        <option value="">Select...</option>
                                        <option value="online" {% if request.GET.modality == 'online' %}selected{% endif %}>Online</option>
                                        <option value="blended" {% if request.GET.modality == 'blended' %}selected{% endif %}>Blended</option>
                                        <option value="in_person" {% if request.GET.modality == 'in_person' %}selected{% endif %}>In-Person</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-md-2">
                                <button type="submit" class="btn btn-primary mt-4">Filter</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
<!-- Filter Summary Section -->
<section class="filter-summary-section container mt-4">
    <div class="row">
        <div class="col-md-12 d-flex justify-content-between align-items-center">
            <div>
                <p><strong>{{ filters.total_results }} results</strong>
                {% if filters.search_query %}
                    for <span class="filter-box">{{ filters.search_query }}</span>
                {% endif %}
                {% if filters.subject_area %}
                    <span class="filter-box">{{ filters.subject_area }}</span>
                {% endif %}
                {% if filters.price %}
                    <span class="filter-box">{{ filters.price|capfirst }}</span>
                {% endif %}
                {% if filters.start_date %}
                    <span class="filter-box">
                        {% if filters.start_date == '1_week' %}Within 1 week{% endif %}
                        {% if filters.start_date == '1_month' %}Within 1 month{% endif %}
                        {% if filters.start_date == '3_months' %}Within 3 months{% endif %}
                        {% if filters.start_date == '6_months' %}Within 6 months{% endif %}
                        {% if filters.start_date == '1_year' %}Within 1 year{% endif %}
                    </span>
                {% endif %}
                {% if filters.duration %}
                    <span class="filter-box">
                        {% if filters.duration == '0_1' %}0 - 1 week{% endif %}
                        {% if filters.duration == '1_3' %}1 - 3 weeks{% endif %}
                        {% if filters.duration == '3_6' %}3 - 6 weeks{% endif %}
                        {% if filters.duration == '6_9' %}6 - 9 weeks{% endif %}
                        {% if filters.duration == '9_12' %}9 - 12 weeks{% endif %}
                        {% if filters.duration == '12_plus' %}12+ weeks{% endif %}
                    </span>
                {% endif %}
                {% if filters.modality %}
                    <span class="filter-box">{{ filters.modality|capfirst }}</span>
                {% endif %}
                </p>
            </div>
            <div>
                {% if filters.search_query or filters.subject_area or filters.price or filters.start_date or filters.duration or filters.modality %}
                    <a href="{% url 'all_courses' %}" class="btn btn-danger btn-clear-filters">Clear All Filters</a>
                {% endif %}
            </div>
        </div>
    </div>
</section>


    <!-- Course Cards Section -->
<section id="courses-section" class="container mt-5">
    <div class="row">
        {% for course in courses %}
        <div class="col-md-4 mb-4">
            <div class="card">
                <img class="card-img-top" src="{{ course.cover_image.url }}" alt="{{ course.name }}">
                <div class="card-body">
                    <div class="card-category-modality">
                        <p class="card-category"><i class="fas fa-book"></i> {{ course.category.name }}</p>
                        <p class="card-modality"><i class="fas fa-laptop"></i> {{ course.modality|capfirst }}</p>
                    </div>
                    <h5 class="card-title">{{ course.name }}</h5>
                    <p class="card-text">{{ course.description|truncatewords:20 }}</p>
                    <div class="card-price-duration">
                        <p class="card-price">${{ course.price }}</p>
                        <p class="card-duration">{{ course.duration_weeks }} weeks long</p>
                        <p class="card-start-date">Register by {{ course.start_date|date:"M d" }}</p>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    <div class="row">
        <div class="col-12">
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    {% if page_obj.has_previous %}
                    <li class="page-item">
                        <a class="page-link" href="?page=1" aria-label="First">
                            <span aria-hidden="true">&laquo;&laquo;</span>
                        </a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    {% endif %}
                    {% for num in page_obj.paginator.page_range %}
                    <li class="page-item {% if page_obj.number == num %}active{% endif %}">
                        <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                    </li>
                    {% endfor %}
                    {% if page_obj.has_next %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                    <li class="page-item">
                        <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}" aria-label="Last">
                            <span aria-hidden="true">&raquo;&raquo;</span>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </div>
</section>

    <footer class="footer">
        <p>&copy; 2024 Love and Kindness LLC. All Rights Reserved.</p>
    </footer>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
